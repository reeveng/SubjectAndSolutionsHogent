---
title: "Oplossing oefening"
author: "Jens Buysse"
date: "30/4/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Een oefening op LP in R, grafisch en stelselmatig opgelost volgens simplex

Voor de productie van twee producten $P_1$ en $P_2$ zijn 120 machines en 180 arbeiders beschikbaar. De productiesnelheid per machine en per maand bedraagt 500kg voor $P_1$ en 1000kg voor $P_2$. Bij de productie is 1 man per ton $P_1$ en drie man per ton $P_2$ nodig. De maximale verkoopscapaciteit $(P_1 + P_2)$ bedraagt 80 ton per jaar. $P_1$ levert een winst op van 300 euro per ton, $P_2$ een winst van 400euro per ton. Welke productmix (per maand) geeft maximale winst ?

Dit kan omgezet worden in een Lineair programma als volgt:

\[ \textrm{Max}(3 x_1 + 4 x_2) \]
Onder de volgende voorwaarden ( we schrijven expliciet alle co??fici??nten voluit.)

\[ \begin{aligned}
1 \times x_1  & + 0 \times x_2 & \leq & 60 \\
0 \times x_1 & + 1 \times x_2  & \leq &120 \\
1 \times x_1  & + 3 \times x_2 & \leq & 180 \\
1 \times x_1  & + 1 \times x_2  & \leq & 80 \\
x_i & \geq 0 & \forall i \in \{ 1,2\}
\end{aligned}
\]
We kunnen dit ook als een matrix vermenigvuldiging schrijven.

\[
\textrm{Max}(
\begin{bmatrix}
    3 & 4 \\
\end{bmatrix} \times
\begin{bmatrix}
    x_1 \\
    x_2 \\
\end{bmatrix})
\]


$A \times X \leq B$:
\[
\begin{bmatrix}
    1 & 0 \\
    0 & 1 \\
    1 & 3 \\
    1 & 1
\end{bmatrix} \times
\begin{bmatrix}
    x_1 \\
    x_2 \\
\end{bmatrix}
\leq
\begin{bmatrix}
  60 \\
  120 \\
  180 \\
  80 \\
\end{bmatrix}
\]

### Oplossing in R

```{r }
library(lpSolve)
C = c(3,4)

A <- matrix(c(  1,0,
                0,1,
                1,3,
                1,1
              ),nrow = 4, byrow = T)

B <- c(60,120,180,80)

# Ongelijkheden of gelijkheden
constranints_direction  <- c("<=", "<=","<=", "<=")

# Find the optimal solution
optimum <-  lp(direction="max",
               objective.in = C,
               const.mat = A,
               const.dir = constranints_direction,
               const.rhs = B,
               all.int = F)
A
B
C
# Print status: 0 = succes, 2 = geen optimale oplosssing
print(optimum$status)

# Display the optimum values for x_1, x_2 
best_sol <- optimum$solution
names(best_sol) <- c("x_1", "x_2") 
print(best_sol)

# Check the value of objective function at optimal point
print(paste("Max: ", optimum$objval, sep=""))


```

We kunnen ook de library solveLP gebruiken

```{r }
library(linprog)
#names(c) <- c("x_1","x_2")
solveLP( cvec = C, bvec = B, Amat= A, maximum = T, const.dir = constranints_direction, solve.dual = T, verbose =4)

```

### Grafisch oplossen in R

Je kan gebruik maken van het commando

>solve2dlp 

van de package

>intpoint


```{r }
library(intpoint)

#t = 1 max, -1 min

# Defineer matrix voor de ongelijkheden van vorm <= 
m <-  matrix(c(  1,0,
                0,1,
                1,3,
                1,1
              ),nrow = 4, byrow = T)
# Definieer de matrix voor de constanten passende bij de ongelijkheden met <=
bm <- c(60,120,180,80)

# Matrix voor de objectieffunctie
c = c(3,4)

solve2dlp(t=1, m=m, bm=bm, c=c, z=1, ip=0)

```

### Oplossen aan de hand van de simplexmethode

We gaan hiervoor het probleem in standaardvorm omzetten

\[ \textrm{Max}(3 x_1 + 4 x_2) \]
Onder de volgende voorwaarden (we schrijven expliciet alle co??fici??nten voluit.)

\[ \begin{aligned}
1 \times x_1  & + 0 \times x_2 & +  y_1 & \leq & 60 \\
0 \times x_1  & + 1 \times x_2 & + y_2 & \leq &120 \\
1 \times x_1  & + 3 \times x_2 & + y_3 & \leq  & 180 \\
1 \times x_1  & + 1 \times x_2 & + y_4 & \leq  & 80 \\
x_i & \geq 0 & \forall i \in \{ 1,2\} \\
y_i & \geq 0 & \forall i \in \{ 1,2,3,4\} \\
\end{aligned}
\]



