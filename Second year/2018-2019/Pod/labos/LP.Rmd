---
title: "Lineair programmeren in R"
author: "Jens Buysse"
date: "23/4/2019"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load lpSolve
require(lpSolve)
```


## Probleem boer Frans
We bepalen de variabelen, en de matrix C
``` {r }
C = c(220,255)
```
We bepalen de beperkingen en de matrix A
``` {r }
A <- matrix(c(1,1,
              10, 20,
              2,1),nrow = 3, byrow = T)

A
```
We bepalen de matrix B:
``` {r }
B <- c(20, 300,36)

B
```
We lossen het probleem op:
```{r }
# Direction of the constraints
constranints_direction  <- c("<=", "<=", "<=")

# Find the optimal solution
optimum <-  lp(direction="max",
               objective.in = C,
               const.mat = A,
               const.dir = constranints_direction,
               const.rhs = B,
               all.int = F)
```
We schrijven de oplossing uit:

```{r }
# Print status: 0 = success, 2 = no feasible solution
print(optimum$status)

# Display the optimum values for x_4p, x_3p and x_w
best_sol <- optimum$solution
names(best_sol) <- c("x_tarwe", "x_gerst") 
print(best_sol)

# Check the value of objective function at optimal point
print(paste("Totale opbrengst: ", optimum$objval, sep=""))


```






## Probleemstelling

>> A company produces two models of chairs: 4P and 3P. The model 4P needs 4 legs, 1 seat and 1 back. On the other hand, the model 3P needs 3 legs and 1 seat. The company has a initial stock of 200 legs, 500 seats and 100 backs. If the company needs more legs, seats and backs, it can buy standard wood blocks, whose cost is 80 euro per block. The company can produce 10 seats, 20 legs and 2 backs from a standard wood block. The cost of producing the model 4P is 30 euro/chair, meanwhile the cost of the model 3P is 40 euro/chair. Finally, the company informs that the minimum number of chairs to produce is 1000 units per month. Define a linear programming model, which minimizes the total cost (the production costs of the two chairs, plus the buying of new wood blocks).

## Formulering
First, we need to translate the problem in a mathematical way. Let???s define the following variables

$x_{4p}$ is the number of 4P chairs to be produced.
$x_{3p}$ is the number of 3P chairs to be produced.
$x_w$ is the number of wood blocks to be bought.


Now we can define $\hat X = \begin{pmatrix} x_{4p} \\ x_{3p}  \\  x_w \end{pmatrix}$ as the decision variable vector. Note that it must be $\hat X \geq 0$.

We would like to minimize the total cost so we must set our objective function as follows

\[cost(x_{4p}, x_{3p}, x_w) = 30 x_{4p} + 40 x_{3p} + 80 x_w = Min(cost)\]


which means that 

\[\hat C = \begin{pmatrix} 30 \\ 40  \\  80 \end{pmatrix}\]

The constraints can be set in the following way


- For the seats $x_{4p} + x_{3p} \leq 500 + 10 x_w$
- For the legs $4 x_{4p} + 3 x_{3p} \leq 200 + 20 x_w$
- For the backs $x_{4p} \leq 100 + 2 x_w$
- Minimum number of chairs produced $x_{4p} + x_{3p} \geq 1000$


We can now define the coefficient matrix 
\[A = \begin{pmatrix} 1 & 1 & -10 & \\  4 & 3 & -20 & \\  1 & 0 & -2 & \\  -1 & -1 & 0 &  \end{pmatrix}\]

and 

\[B = \begin{pmatrix} 500 \\ 200 \\ 100 \\ -1000 \end{pmatrix}\]

```{r }

## Set the coefficients of the decision variables -> C
C <- c(30, 40, 80)

# Create constraint martix B
A <- matrix(c(1, 1, -10,
              4, 3, -20,
              1, 0, -2,
              1, 1, 0), nrow=4, byrow=TRUE)

# Right hand side for the constraints
B <- c(500, 200, 100, 1000)

# Direction of the constraints
constranints_direction  <- c("<=", "<=", "<=", ">=")

# Find the optimal solution
optimum <-  lp(direction="min",
               objective.in = C,
               const.mat = A,
               const.dir = constranints_direction,
               const.rhs = B,
               all.int = T)

# Print status: 0 = success, 2 = no feasible solution
print(optimum$status)

# Display the optimum values for x_4p, x_3p and x_w
best_sol <- optimum$solution
names(best_sol) <- c("x_4p", "x_3p", "x_w") 
print(best_sol)

# Check the value of objective function at optimal point
print(paste("Total cost: ", optimum$objval, sep=""))

rm(optimum, constranints_direction, best_sol)

```

# Probleem uit cursus

``` {r }

C <- c(4.8, 12, 6, 7.2)
C
# Create constraint martix A
A <- matrix(c(0.70, 0.75, 0.55, 0.34,
              0.55, 0.82, 0.80, 0.55,
              0.24, 0.32, 0.45, 0.27,
              1.9, 2.5, 1.8, 2, 
              1, 0, 0, 0), nrow=5, byrow=TRUE)

A
# Right hand side for the constraints
B <- c(400, 480, 220, 1500, 100)
B

# Direction of the constraints
constranints_direction  <- c("<=", "<=", "<=","<=", ">=")

optimum <-  lp(direction="max",
               objective.in = C,
               const.mat = A,
               const.dir = constranints_direction,
               const.rhs = B,
               all.int = T)

# Print status: 0 = success, 2 = no feasible solution
print(optimum$status)

best_sol <- optimum$solution
names(best_sol) <- c("x_A", "x_B", "x_C", "x_D") 
print(best_sol)
# Check the value of objective function at optimal point
print(paste("Total cost: ", optimum$objval, sep=""))
```